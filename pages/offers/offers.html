<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
            crossorigin="anonymous"
        />
        <link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"
        />
        <link rel="stylesheet" href="../../navbar/nav_styles.css" />
        <link rel="stylesheet" href="../../main.css" />
        <link rel="stylesheet" href="../rides/rides_list/toggle_button.css" />
        <!-- <link rel="stylesheet" href="./offers.css" /> -->
        <link rel="stylesheet" href="../rides/rides_list/card.css" />
        <style>
        tbody > tr:hover{
            background-color: #BEDAD6;
        }

        /* #top_row{ */
            /*width:100%;*/
            /*position: fixed;*/
            /*z-index: 1;*/
            /*background-color:#e3f1ef;*/
            /*top:12.8vh*/
        /* } */
        </style>
        <title>Offers</title>
    </head>
    <body>
        <div id="navbarVue">
            <div
                v-html="navbar_html"
                @scroll="nav_animation"
                data-page="offers"
            ></div>
        </div>
        <div id="populate_listings" class="w-100 ">

            <div id="top_row" style="text-align: center; background-color: #e3f1ef">
                        <h1 class="">Offers</h1>
            </div>

            <div id="driver" v-if="driver_listings.length>0">
                <div style="height: 40px"></div>
                <div class="col-10 col-md-8 mx-auto text-start ">

                    <h4>My Scheduled Drives</h4>
                <table class="table text-center mx-3 ">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Time</th>
                        <th scope="col">From</th>
                        <th scope="col">To</th>
                        <th scope="col">Seats</th>
                        <th scope="col">Price</th>
                    </tr>
                </thead>
                    <tbody>
                    <tr v-for="listing in driver_listings" v-on:click="redirect(listing.ride_id)">
                        <td>{{format_date(listing.date)[1]}}</td>
                        <td>{{formatAMPM(listing.time)}}</td>
                        <td class="">{{listing.smu_to_from =="from"? listing.smu_location: listing.formatted_address}}</td>
                        <td>{{listing.smu_to_from =="to"? listing.smu_location: listing.formatted_address}}</td>
                        <td>{{listing.users_offered.length-1}} / {{listing.max_capacity}}</td>
                        <td>${{listing.cost}}</td>
                    </tr>
                    </tbody>
                </table>
                </div>
            </div>
            <div id="rider" v-if="rider_temp.length>0">
                <div class="col-10 col-md-8 mx-auto text-start">
                    <div class="d-flex justify-content-between">

                        <div class="py-auto">
                            <h4 class="my-auto">My Scheduled Rides</h4>
                        </div>
                        <div>
                            <label class="switch">
                                <input type="checkbox" id="togBtn" v-on:change="change_direction()">
                                <div class="slider round">
                                    <!--ADDED HTML -->
                                    <span class="on" style=" position:absolute; right:17px; top:15px"> To</span>
                                    <span class="on" style=" position:absolute; right:1px; top: 31px"> SMU</span>
                                    <span class="off" style=" position:absolute; right:17px; top:15px"> From</span>
                                    <span class="off" style=" position:absolute; right:20px; top: 31px"> SMU</span>
                                    <!--END-->
                                </div>
                            </label>
                        </div>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <div class="card col-sm-6 col-md-4 col-lg-3" v-for="listing in rider_listings">
                        <div class="card-body col py-0">

                            <a class="stretched-link" v-bind:href="'./../../pages/rides/ride_details/rides_indiv_rider.html?rideid=' + listing.ride_id"></a>
                            <span class="badge rounded-pill px-1" v-if="listing.frequency === 'recurring'" hidden>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
                            <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                            <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                        </svg>
                    </span>

                            <div class="d-flex mt-4">

                                <div class="bd-highlight col-4 my-auto">

                                    <div class="d-flex justify-content-center">
                                        <!-- <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-2.webp"
                                             alt="Generic placeholder image" class="img-fluid rounded-circle border"
                                        > -->
                                        <!-- KEN MING REPLACED THE ABOVE WITH THIS -->
                                        <img
                                                :src="get_url(listing['driver_username'])"
                                                class="profile-pic img-fluid rounded-circle rounded-circle-dp"
                                                style="
                                            object-fit: cover;
                                            height: 60px;
                                            width: 60px;
                                            object-position: 50% 50%;
                                            border: black solid 1px;
                                        "
                                        />
                                    </div>
                                </div>
                                <div class="col-8">
                                    <div class="text-center overflow-visible">
                                        <h5 class="mb-0 py-2">
                                            {{get_user_name(listing.driver_username)}}
                                        </h5>
                                        <h5 class="my-0 fw-bold">
                                            {{format_date(listing.date)[1]}}
                                        </h5>
                                        <h5 class="my-0 fw-bold">
                                            {{format_date(listing.date)[0]}}
                                            {{formatAMPM(listing.time)}}
                                        </h5>
                                    </div>
                                </div>
                            </div>

                            <hr class="mb-1 mt-2" />
                            <div>

                                <h2 class="card-title fw-bold text-center mb-3 neighbourhood" v-if="to_from == `From`" style="color: #BFACD3">
                                    <i class="bi bi-geo-alt-fill"></i>{{listing.neighbourhood}}
                                    <span class="tooltiptext" style="background-color: #BFACD3; color: #451F6A;">
                                    <h6 class="formatted-address" style="color: #451F6A;">{{listing.formatted_address}}</h6>
                                </span>
                                </h2>
                                <h2 class="card-title fw-bold text-center mb-3 neighbourhood" v-else-if="to_from == `To`" style="color: #d8c7a3">
                                    <i class="bi bi-geo-alt-fill"></i>{{listing.neighbourhood}}
                                    <span class="tooltiptext" style="background-color: #d8c7a3; color: #8A6F42;">
                                    <h6 class="formatted-address" style="color: #8A6F42;">{{listing.formatted_address}}</h6>
                                </span>
                                </h2>

                                <div class="d-flex my-2">

                                    <h1 class="me-auto">${{listing.cost}}</h1>

                                    <h1>{{listing.max_capacity - listing.users_offered.length+ 1}}<i class="bi bi-person-fill"></i></h1>

                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            </div>
        </div>
   

    </body>

<!-- <script>
    const user_name = "BobTan123"
    localStorage.user= user_name
</script> -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
    crossorigin="anonymous"
></script>
<script src="offers.js" type="module"></script>
<script src="../../navbar/navbar.js" type="module"></script>
</html>
