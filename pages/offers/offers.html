<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
            crossorigin="anonymous"
        />
        <link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"
        />
        <link rel="stylesheet" href="../../navbar/nav_styles.css" />
        <link rel="stylesheet" href="../../main.css" />
        <link rel="stylesheet" href="../rides/rides_list/toggle_button.css" />
        <link rel="stylesheet" href="../rides/rides_list/offers.css" />
        <link rel="stylesheet" href="../rides/rides_list/card.css" />
        <style>
        tbody > tr:hover{
            background-color: #BEDAD6;
        }

        #top_row{
            width:100%;
            position: fixed;
            z-index: 1;
            background-color:#e3f1ef;
            top:12.8vh
        }
        </style>
        <title>Offers</title>
    </head>
    <body>
        <div id="navbarVue">
            <div
                v-html="navbar_html"
                @scroll="nav_animation"
                data-page="offers"
            ></div>
        </div>
        <div id="populate_listings" class="w-100 ">

            <div id="top_row" style="text-align: center; background-color: #e3f1ef">
                        <h1 class="">Offers</h1>
            </div>

            <div id="driver" v-if="driver_listings.length>0">
                <div style="height: 40px"></div>
                <div class="col-10 col-md-8 mx-auto text-start ">

                    <h4>My Scheduled Drives</h4>
                <table class="table text-center mx-3 ">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Time</th>
                        <th scope="col">From</th>
                        <th scope="col">To</th>
                        <th scope="col">Seats</th>
                        <th scope="col">Price</th>
                    </tr>
                </thead>
                    <tbody>
                    <tr v-for="listing in driver_listings" v-on:click="redirect(listing.ride_id)">
                        <td>{{format_date(listing.date)[1]}}</td>
                        <td>{{formatAMPM(listing.time)}}</td>
                        <td class="">{{listing.smu_to_from =="From"? listing.smu_location: listing.user_address}}</td>
                        <td>{{listing.smu_to_from =="To"? listing.smu_location: listing.user_address}}</td>
                        <td>{{listing.users_offered==undefined? `0`:listing.users_offered.length}} / {{listing.max_capacity}}</td>
                        <td>${{listing.cost}}</td>
                    </tr>
                    </tbody>
                </table>
                </div>
            </div>
            <div id="rider" v-if="rider_temp.length>0">
                <div class="col-10 col-md-8 mx-auto text-start">
                    <div class="d-flex justify-content-between">

                        <div class="py-auto">
                            <h4 class="my-auto">My Scheduled Rides</h4>
                        </div>
                        <div>
                            <label class="switch">
                                <input type="checkbox" id="togBtn" v-on:change="change_direction()">
                                <div class="slider round">
                                    <!--ADDED HTML -->
                                    <span class="on" style=" position:absolute; right:17px; top:15px"> To</span>
                                    <span class="on" style=" position:absolute; right:1px; top: 31px"> SMU</span>
                                    <span class="off" style=" position:absolute; right:17px; top:15px"> From</span>
                                    <span class="off" style=" position:absolute; right:20px; top: 31px"> SMU</span>
                                    <!--END-->
                                </div>
                            </label>
                        </div>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <div class="card mx-3" v-for="listing in rider_listings">
                        <div class="card-body col py-0">

                            <a class="stretched-link" v-bind:href="'./../ride_details/rides_indiv_rider.html?rideid=' + listing.ride_id"></a>


                            <div class="d-flex mt-4">

                                <div class="bd-highlight col-4 my-auto">

                                    <div class="d-flex justify-content-center">
                                        <!-- <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-2.webp"
                                             alt="Generic placeholder image" class="img-fluid rounded-circle border"
                                        > -->
                                        <!-- KEN MING REPLACED THE ABOVE WITH THIS -->
                                        <img :src="get_url(listing['driver_username'])" class="profile-pic img-fluid rounded-circle rounded-circle-dp"
                                             style="object-fit: contain; height: 60px; width: 60px; object-position: 50% 50%;border:black solid 1px" >
                                    </div>

                                </div>
                                <div class="col-8">

                                    <div class="text-center overflow-visible ">

                                        <h5 class="mb-0 py-2 ">{{get_user_name(listing.driver_username)}}</h5>
                                        <h5 class="my-0 fw-bold">{{format_date(listing.date)[1]}}</h5>
                                        <h5 class="my-0 fw-bold">{{format_date(listing.date)[0]}} {{formatAMPM(listing.time)}}</h5>

                                    </div>

                                </div>
                            </div>
                            <hr class="mb-1 mt-2" />
                            <div>

                                <h2 class="card-title fw-bold text-center mb-3" v-if="to_from == `From`" style="color: #BFACD3">
                                    <i class="bi bi-geo-alt-fill"></i>{{listing.area}}
                                </h2>
                                <h2 class="card-title fw-bold text-center mb-3" v-else-if="to_from == `To`" style="color: #d8c7a3">
                                    <i class="bi bi-geo-alt-fill"></i>{{listing.area}}
                                </h2>

                                <div class="d-flex my-2">

                                    <h1 class="me-auto">${{listing.cost}}</h1>

                                    <h1>{{listing.max_capacity - listing.users_offered.length}}<i class="bi bi-person-fill"></i></h1>

                                </div>

                            </div>

                        </div>

                    </div>

                </div>
            </div>
            </div>
        </div>
   

    </body>
    <script>
        const user_name = "BobTan123";
        localStorage.user = user_name;
    </script>

<!-- <script>
    const user_name = "BobTan123"
    localStorage.user= user_name
</script> -->
<script src="offers.js" type="module"></script>
<script src="../../navbar/navbar.js" type="module"></script>
</html>
